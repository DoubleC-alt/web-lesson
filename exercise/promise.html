<html>
    <head>
        <title>promise练习</title>
    </head>
    <body>
        <button onclick="simpleAsyncfn()">普通的异步操作</button>
        <button onclick="hardAsyncfn()">复杂的异步操作</button>
        <button onclick="simpleAsyncPromisefn()">promise的异步操作</button>
        <button onclick="errAsyncPromisefn()">失败的promise的异步操作</button>
        <button onclick="asyncPromisefn()">完整的promise的异步操作</button>
    </body>
</html>
<script>
function simpleAsyncfn(){
    setTimeout(()=>{
        console.log("异步操作")
    },2000)
}

function hardAsyncfn(){
    setTimeout(()=>{
        console.log(1000)
        setTimeout(()=>{
            console.log(2000)
            setTimeout(()=>{
                console.log(3000)
            },1000)
        },1000)
    },1000)
}

function simpleAsyncPromisefn(){
    const p1 = new Promise((resolve,reject)=>{
        setTimeout(()=>{
            resolve(new Date())
        },1000)
    })

    p1.then((res)=>{
        console.log(res)
    }).catch((e)=>{
        console.log(e)
    })

}

function errAsyncPromisefn(){
    const p1 = new Promise((resolve,reject)=>{
        setTimeout(()=>{
            reject("FAIL")
        },1000)
    })

    p1.then((res)=>{
        console.log(res)
    }).catch((e)=>{
        console.log(e)
    })
}

function asyncPromisefn(){
    const p = new Promise((resolve,reject)=>{
        setTimeout(()=>{
            let r = Math.random()
            if(r > 0.5){
                resolve(100)
            }else{
                reject(200)
            }
        },1000)
    })

    p.then((res)=>{
        console.log(res)
        return new Promise((resolve)=>{
            setTimeout(()=>{
                console.log("第二次模拟请求")
                resolve(300)
            })
        })
    })
    .then((res)=>{
        console.log(res)
    })
    .catch((e)=>{
        console.log(new Error())
    })
}

</script>